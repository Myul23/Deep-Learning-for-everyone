# Chatper 11. 데이터 다루기

11장 데이터 다루기에서는

피마 인디언 데이터를 이용한 당뇨병 예측 신경망을 구성합니다.

먼저 데이터를 확인하고, / 데이터 가공을 통한 전처리를 진행한 이후에, / 예측 모형을 만드는 방식입니다.

가장 먼저 판다스 패키지의 / read_csv 함수를 통해 피마 인디언 데이터를 / 불러옵니다. / 
이때, names 매개변수를 통해 / 각 열의 이름을 지정해서 불러옵니다. / 데이터를 확인하는 작업은 / 대체로 3가지가 있습니다.

```
pregnant: 과거 임신 횟수
plasma: 포도당 부하 검사 2시간 후 공복 혈당 농도
pressure: 확장기 혈압
thickness: 삼두근 피부 주름 두께
insulin: 혈청 인슐린
BMI: 체질량 지수
pedigree: 당뇨병 가족력
gage: 나이
class: 1(당뇨), 0(아님)
```

첫번째로 데이터를 직접 확인하는 것입니다. / 
여기서는 head 함수를 통해 / 처음 5개의 행만을 확인했습니다.

두번째는 info 함수를 통해 / 데이터의 기본적인 특성만 파악하는 것입니다. / 
열마다 데이터의 갯수, 결측치, 데이터 타입을 / 한 번에 확인할 수 있습니다.

마지막으로 desribe 함수를 통해 / 평균, 표준편차 등의 수치로 / 데이터를 확인하는 것입니다. / 
이렇게 데이터를 확인한 이후엔 / 각 열이 서로에게 주는 영향을 확인해야 합니다.

plotting을 위해서 / matplotlib 패키지의 pyplot과 / seaborn 패키지를 이용합니다. / 
pyplot의 figure 함수를 통해 / plot의 전체적인 비율 및 크기를 잡아주고, / 데이터의 열 단위의 상관계수와 / heatmap 함수를 통해 plotting을 시도합니다.

이때, 각 상관계수를 표현해줄 색은 pyplot의 내장된 color-map 중 보편적으로 heat을 표현하는 것으로 하고, / 각 셀을 구분지어줄 선은 하얀색의 0.1의 두께를 갖고, / 색을 표현할 최댓값을 0.5로 하며 / 애낫을 True로 해서 각 셀마다 / 상관계수 값을 보이게 합니다. / 
이를 확대해서

당뇨병에 대한 열은 / 가장 아래에 있는 class이고, / 이 열과 가장 높은 상관계수를 갖는 열은 / 0.47의 plasma 열임을 알 수 있습니다.

그래서 seaborn 패키지의 패셋-grid를 통해 / class 값에 따른 plasma histogram을 그렸습니다. / 오른쪽이 class가 1로 / 당뇨병일 때의 plasma 값에 분포고, / 왼쪽이 당뇨가 아닐 때입니다. / 
당뇨가 아닐 때의 분포는 / 중간에 몰려있긴 하지만, 전체적인 plasma 값 범위를 다 아우릅니다. / 
그러나 당뇨가 있을 때는 / 없을 때의 중간을 기준으로 / 더 큰 값에 쏠려 있음을 알 수 있습니다. / 
plasma가 일정 시간 이후에 혈당 농도라는 점을 생각하면 / 당뇨병이 있는 사람에서 높은 점은 크게 놀라운 점은 아닐 수도 있습니다. /
이렇게 데이터 가공, 전처리 과정을 통해 / 결과에 영향을 주는 열이자 변수를 확인할 수 있습니다.

다음으로 예측 모형의 구성입니다. / 
tensorflow, numpy 패키지와 더불어 / 계층 쌓기를 위한 Sequential 함수와 / Dense 함수를 이용해 모형을 구성할 겁니다.

numpy와 tensorflow의 seed를 3으로 지정하므로써 / 이후 있을 가중치 초깃값을 특정 값으로 고정합니다. / 
이는 전체적으로 반복했을 때 / 같은 가중치의 모형을 구성하게 하기 위함입니다.

데이터를 loadtxt 함수에서 콤마로 구분해 불러오고 / 이를 input과 output으로 나눕니다.

sequential 함수를 통해 계층을 구성할 준비를 하고 / 계층을 추가해 나갑니다. /
처음으로 activation function으로 relu를 이용하고 output이 12개인 Affine 계층을 / 두번째로 마찬가지고 relu를 이용하고 output이 8개인 계층을 / 마지막으로 sigmoid를 이용하고 output이 하나인 계층을 구성합니다. /
이후에 compile 함수에서 / loss는 cross entropy를 통해 계산하고, / adam을 통해 기울기를 최적화하며 / accuracy를 이용해 모형을 평가할 수 있게 합니다. / 
나아가 fit 함수에서 input과 output을 주고, / batch size를 10으로 하고 / 전체적으로 200번 반복시킵니다. / 
이후 해당 모형의 accuracy를 출력하게 하는 건데, / 이를 실행시켜 보면

구성한 모델의 정확도가 0.7253으로 / 나쁘지 않은 값을 보입니다. / 
결과적으로 / 피마 인디언에 대한 당뇨병 예측에 / 72%의 정확도를 보이는 모형을 구성했습니다.

마지막으로 저는 / 이러한 딥러닝 기술로 노래 표절율에 대한 모형을 구성해보고 싶습니다.

이상으로 11장 발표를 마칩니다.
